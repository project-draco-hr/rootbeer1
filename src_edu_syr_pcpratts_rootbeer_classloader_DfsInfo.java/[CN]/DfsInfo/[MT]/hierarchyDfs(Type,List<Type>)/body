{
  List<Type> children=m_parentsToChildren.get(curr);
  if (children == null) {
    children=new ArrayList<Type>();
  }
  for (  Type child : children) {
    stack.add(child);
    hierarchyDfs(child,stack);
    stack.remove(stack.size() - 1);
  }
  for (int i=0; i < stack.size(); ++i) {
    Type stack_value=stack.get(i);
    List<NumberedType> curr_parents=null;
    if (m_hierarchyDown.containsKey(stack_value)) {
      curr_parents=m_hierarchyDown.get(stack_value);
    }
 else {
      curr_parents=new ArrayList<NumberedType>();
      m_hierarchyDown.put(stack_value,curr_parents);
    }
    for (int j=i; j < stack.size(); ++j) {
      Type child=stack.get(j);
      NumberedType ntype=m_numberedTypeMap.get(child);
      if (curr_parents.contains(ntype) == false) {
        curr_parents.add(ntype);
      }
    }
  }
}
