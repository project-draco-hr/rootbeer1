{
  String cuda_code=builder.toString();
  String mangle=NameMangling.v().mangle(VoidType.v());
  String replacement=getRuntimeBasicBlockClassName() + "_gpuMethod" + mangle;
  replacement=replacement.replace("$","\\$");
  cuda_code=cuda_code.replaceAll("%%invoke_run%%",replacement);
  int string_builder_number=RootbeerClassLoader.v().getClassNumber("java.lang.StringBuilder");
  String sbn_str="" + string_builder_number;
  cuda_code=cuda_code.replaceAll("%%java_lang_StringBuilder_TypeNumber%%",sbn_str);
  int null_pointer_number=RootbeerClassLoader.v().getClassNumber("java.lang.NullPointerException");
  String np_str="" + null_pointer_number;
  cuda_code=cuda_code.replaceAll("%%java_lang_NullPointerException_TypeNumber%%",np_str);
  int size=Configuration.compilerInstance().getSharedMemSize();
  String size_str="" + size;
  cuda_code=cuda_code.replaceAll("%%shared_mem_size%%",size_str);
  int string_number=RootbeerClassLoader.v().getClassNumber("java.lang.String");
  String string_str="" + string_number;
  cuda_code=cuda_code.replaceAll("%%java_lang_String_TypeNumber%%",string_str);
  return cuda_code;
}
