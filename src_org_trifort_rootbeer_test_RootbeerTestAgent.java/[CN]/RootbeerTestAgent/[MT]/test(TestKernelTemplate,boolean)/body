{
  int i=0;
  try {
    Rootbeer rootbeer=new Rootbeer();
    Configuration.setPrintMem(print_mem);
    Kernel known_good_item=creator.create();
    Kernel testing_item=creator.create();
    ThreadConfig thread_config=creator.getThreadConfig();
    Stopwatch watch=new Stopwatch();
    watch.start();
    Context context=rootbeer.createDefaultContext();
    context.setKernel(testing_item);
    context.setThreadConfig(thread_config);
    context.buildState();
    context.run();
    context.close();
    m_passed=true;
    watch.stop();
    m_gpuTime=watch.elapsedTimeMillis();
    watch.start();
    RootbeerGpu.setBlockDimx(thread_config.getBlockShapeX());
    RootbeerGpu.setGridDimx(thread_config.getGridShapeX());
    for (int block=0; block < thread_config.getGridShapeX(); ++block) {
      for (int thread=0; thread < thread_config.getBlockShapeX(); ++thread) {
        int thread_id=block * thread_config.getBlockShapeX() + thread;
        if (thread_id < thread_config.getNumThreads()) {
          RootbeerGpu.setBlockIdxx(block);
          RootbeerGpu.setThreadIdxx(thread);
          RootbeerGpu.setThreadId(thread_id);
          known_good_item.gpuMethod();
        }
      }
    }
    watch.stop();
    m_cpuTime=watch.elapsedTimeMillis();
    if (!creator.compare(known_good_item,testing_item)) {
      m_message="Compare failed at: " + i;
      m_passed=false;
      return;
    }
  }
 catch (  Throwable ex) {
    ex.printStackTrace(System.out);
    m_message="Exception thrown at index: " + i;
    m_passed=false;
  }
}
