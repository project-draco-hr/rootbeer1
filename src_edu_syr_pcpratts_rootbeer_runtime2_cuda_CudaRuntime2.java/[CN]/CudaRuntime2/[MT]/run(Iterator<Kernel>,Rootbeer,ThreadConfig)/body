{
  Stopwatch watch2=new Stopwatch();
  watch2.start();
  RootbeerGpu.setIsOnGpu(true);
  m_Partial=new PartiallyCompletedParallelJob(jobs);
  boolean any_jobs=writeBlocks(jobs);
  if (any_jobs == false) {
    return m_Partial;
  }
  String filename=m_FirstJob.getCubin();
  if (filename.endsWith(".error")) {
    return m_Partial;
  }
  if (thread_config == null) {
    calculateShape();
  }
 else {
    m_BlockShape=thread_config.getBlockShapeX();
    m_GridShape=thread_config.getGridShapeX();
    m_NumBlocksRun=m_GridShape * m_BlockShape;
    if (m_NumBlocksRun > m_JobsWritten.size()) {
      m_NumBlocksRun=m_JobsWritten.size();
    }
  }
  compileCode();
  Stopwatch watch=new Stopwatch();
  watch.start();
  runOnGpu();
  watch.stop();
  m_executionTime=watch.elapsedTimeMillis();
  readBlocks();
  unload();
  runExtraBlocks();
  RootbeerGpu.setIsOnGpu(false);
  m_overallTime=watch2.elapsedTimeMillis();
  StatsRow stats_row=new StatsRow(m_serializationTime,m_executionTime,m_deserializationTime,m_overallTime,m_GridShape,m_BlockShape);
  rootbeer.addStatsRow(stats_row);
  return m_Partial;
}
