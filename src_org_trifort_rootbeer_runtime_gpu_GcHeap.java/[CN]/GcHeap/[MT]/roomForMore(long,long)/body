{
  long next_ref=ref + size + size;
  if (next_ref >= mBufferSize)   return false;
  if ((m_CountWritten * 4) + 4 >= mBufferSize)   return false;
  if (m_CountWritten + 1 > mDevice.getNumBlocks())   return false;
  if (mUsingGarbageCollector) {
    if (mMaxToHandleMapAddress + 4 >= mBufferSize)     return false;
  }
  return true;
}
