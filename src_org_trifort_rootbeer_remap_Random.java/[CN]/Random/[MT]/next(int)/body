{
  long oldseed, nextseed;
  GpuAtomicLong seed2=this.seed;
  do {
    oldseed=seed2.get();
    nextseed=(oldseed * multiplier + addend) & mask;
  }
 while (!seed2.compareAndSet(oldseed,nextseed));
  return (int)(nextseed >>> (48 - bits));
}
